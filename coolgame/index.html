<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>cool ass game bruh</title>
    <style>
        body {
            background: #ff0;
            margin: 0;
        }
        canvas {
            display: block;
            margin: 0 auto;
            background: linear-gradient(45deg, #0ff, #f0f, #0f0, #f00);
            border: 10px dashed #00f;
            touch-action: none;
        }
        #score {
            color: #f00;
            background: #00ff00;
            font-size: 32px;
            text-align: center;
            font-family: "Comic Sans MS", cursive, sans-serif;
            padding: 10px;
            margin-bottom: 0;
        }
        #flashing {
            font-size: 40px;
            font-family: Impact, "Comic Sans MS", cursive, sans-serif;
            text-align: center;
            font-weight: bold;
            margin: 0;
            padding: 10px;
            animation: flash 0.4s infinite alternate;
        }
        .popup-ad {
            position: fixed;
            z-index: 9999;
            width: 220px;
            height: 150px;
            background: linear-gradient(135deg, #ff00ff 0%, #00ffcc 100%);
            border: 7px dotted #ff0;
            color: #000;
            font-family: 'Comic Sans MS', Impact, cursive;
            font-size: 18px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 0 30px #f00, 0 0 10px #00f inset;
            padding: 8px;
            animation: popupFlash 0.15s infinite alternate;
            user-select: none;
        }
        .popup-ad button {
            font-family: 'Comic Sans MS', Impact, cursive;
            background: #ff0;
            border: 4px solid #00f;
            color: #f0f;
            font-size: 17px;
            padding: 2px 14px;
            cursor: pointer;
            margin-top: 10px;
            animation: buttonFlash 0.2s infinite alternate;
        }
        @keyframes flash {
            from { color: #ff00ff; background: #0ff; }
            to { color: #00ff00; background: #f00; }
        }
        @keyframes popupFlash {
            from { box-shadow: 0 0 30px #f00, 0 0 10px #00f inset; }
            to { box-shadow: 0 0 30px #0f0, 0 0 10px #f0f inset; }
        }
        @keyframes buttonFlash {
            from { background: #ff0; color: #f0f; }
            to { background: #0ff; color: #f00; }
        }
        #mobile-controls {
            display: block;
            position: fixed;
            z-index: 1000;
            bottom: 10px;
            left: 0;
            width: 100vw;
            text-align: center;
            pointer-events: none;
            user-select: none;
        }
        .mc-btn {
            display: inline-block;
            width: 70px;
            height: 70px;
            margin: 0 15px;
            background: #ff0;
            border: 5px solid #f0f;
            color: #f00;
            font-family: Impact, "Comic Sans MS", cursive, sans-serif;
            font-size: 34px;
            border-radius: 50%;
            box-shadow: 0 4px 16px #0ff;
            touch-action: none;
            pointer-events: auto;
            user-select: none;
            animation: buttonFlash 0.2s infinite alternate;
            transition: filter 0.1s;
        }
        .mc-btn.active {
            filter: brightness(0.7) drop-shadow(0 0 10px #00f);
        }
    </style>
</head>
<body>
    <div id="score">SCORE: <span id="scoreNum">0</span></div>
    <div id="flashing">TACO TOWN SEATTLE! ðŸŒ® The Best Tacos in the PNW!</div>
    <canvas id="game" width="600" height="400"></canvas>
    <div id="mobile-controls">
        <button class="mc-btn" id="mc-left">&#8592;</button>
        <button class="mc-btn" id="mc-jump">&#8593;</button>
        <button class="mc-btn" id="mc-right">&#8594;</button>
    </div>
    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        const flashingText = document.getElementById('flashing');
        const playerColor = '#000000', coinColor = '#ff8000';
        const platformColors = ['#ff00ff', '#00ffff', '#00ff00', '#ff0000', '#0000ff', '#ffff00', '#ff8800', '#88ff00', '#0088ff', '#ff0088'];
        const tacoAds = [
            "ðŸŒ® TACO TOWN SEATTLE! The Best Tacos in the PNW!",
            "ðŸŒ® Try Our Spicy Seattle Salsa at Taco Town!",
            "ðŸŒ® Taco Tuesday Every Day at Taco Town Seattle!",
            "ðŸŒ® Crunchy, Zesty, Local â€“ Only at Taco Town Seattle!",
            "ðŸŒ® Visit Taco Town Seattle â€“ Where Tacos Rule!",
            "ðŸŒ® TACO TOWN: Now Delivering in Seattle!",
            "ðŸŒ® Free Chips With Every Taco! Only @ Taco Town Seattle",
            "ðŸŒ® HOT DEALS: Buy 2 Tacos, Get 3rd Taco Only $1!",
            "ðŸŒ® Taco Town: We Put the 'Sea' in Seattle Tacos!",
            "ðŸŒ® Life Is Better With Tacos â€“ Taco Town Seattle"
        ];
        const popupAds = [
            "ðŸŒ® TACO TOWN POPUP! 50% OFF if you scream 'TACOS!' at the cashier!",
            "ðŸŒ® Hungry? Order TACO TOWN SEATTLE now!",
            "ðŸŒ® Pop Quiz: How many tacos can you eat? Visit Taco Town and find out!",
            "ðŸŒ® TACO TOWN: Now hiring taco testers in Seattle!",
            "ðŸŒ® BEWARE: Side effects of Taco Town tacos include happiness and salsa addiction.",
            "ðŸŒ® TACO TOWN: Spicier than your last relationship!",
            "ðŸŒ® TACO TOWN: Click here to win infinite tacos! (Just kidding, but come eat some!)",
            "ðŸŒ® TACO TOWN: The only thing better than this game. (Not hard!)"
        ];
        const levels = [
            { platforms: [
                {x:0,y:380,w:600,h:20,c:0}, {x:50,y:300,w:100,h:15,c:1}, {x:200,y:230,w:120,h:12,c:2},
                {x:380,y:160,w:100,h:18,c:3}, {x:500,y:100,w:70,h:15,c:4}
            ], coin: {x:530,y:70,r:12}, playerStart: {x:50,y:350} },
            { platforms: [
                {x:0,y:380,w:600,h:20,c:5}, {x:100,y:320,w:60,h:15,c:6}, {x:230,y:260,w:90,h:12,c:7},
                {x:370,y:200,w:120,h:18,c:8}, {x:150,y:140,w:80,h:13,c:9}, {x:480,y:90,w:100,h:15,c:2}
            ], coin: {x:530,y:60,r:12}, playerStart: {x:40,y:350} },
            { platforms: [
                {x:0,y:390,w:600,h:10,c:3}, {x:60,y:330,w:70,h:10,c:4}, {x:200,y:260,w:120,h:10,c:5},
                {x:350,y:200,w:90,h:10,c:6}, {x:510,y:130,w:60,h:10,c:7}, {x:320,y:70,w:180,h:10,c:8},
                {x:120,y:120,w:60,h:10,c:9}
            ], coin: {x:180,y:90,r:12}, playerStart: {x:15,y:330} },
            { platforms: [
                {x:0,y:395,w:600,h:5,c:0}, {x:100,y:350,w:80,h:10,c:1}, {x:250,y:310,w:70,h:10,c:2},
                {x:420,y:250,w:100,h:10,c:3}, {x:150,y:210,w:60,h:10,c:4}, {x:300,y:170,w:120,h:10,c:5},
                {x:480,y:110,w:80,h:10,c:6}, {x:60,y:110,w:60,h:10,c:7}
            ], coin: {x:110,y:80,r:12}, playerStart: {x:20,y:370} }
        ];
        let levelIndex = 0, score = 0, popupCount = 0, flashCounter = 0, flashText = "", flashTextTimer = 0;
        let keyStates = {};
        let mobileLeft = false, mobileRight = false, mobileJump = false, mobileJumpQueued = false;
        let platforms, coin, player;
        const rand = (a, b) => Math.random() * (b - a) + a;
        function randomColor() {
            return `#${Math.floor(Math.random()*16777215).toString(16).padStart(6,"0")}`;
        }
        function getRandomJumpVelocity() {
            let r = Math.random();
            if (r < 0.15) return -4 - rand(0,2);
            if (r > 0.85) return -14 - rand(0,4);
            return -7 - rand(0,6);
        }
        function startLevel(idx) {
            platforms = levels[idx].platforms.map(p => ({...p}));
            coin = {...levels[idx].coin, collected: false};
            player = {...levels[idx].playerStart, w: 20, h: 30, vy: 0, onGround: false, justJumped: false};
            flashText = tacoAds[idx % tacoAds.length];
            flashTextTimer = 60;
            flashingText.style.color = randomColor();
            flashingText.style.background = randomColor();
            flashingText.textContent = flashText;
            maybeShowPopupAd();
        }
        function maybeShowPopupAd() {
            if (Math.random() < 0.6 || popupCount === 0) setTimeout(showPopupAd, 500 + rand(0,600));
        }
        function showPopupAd() {
            popupCount++;
            const adText = popupAds[Math.floor(Math.random() * popupAds.length)];
            const popup = document.createElement('div');
            popup.className = "popup-ad";
            const winW = window.innerWidth, winH = window.innerHeight;
            popup.style.left = Math.floor(rand(10, winW - 230)) + "px";
            popup.style.top = Math.floor(rand(10, winH - 160)) + "px";
            popup.innerHTML = `<div>${adText}</div><button>Close Ad</button>`;
            popup.querySelector('button').onclick = () => {
                popup.remove();
                if (Math.random() < 0.18) setTimeout(showPopupAd, 400);
            };
            document.body.appendChild(popup);
        }
        setInterval(() => {
            if (Math.random() < (window.innerWidth < 700 ? 0.6 : 0.33)) showPopupAd();
        }, 3500);
        window.addEventListener('resize', () => {
            document.querySelectorAll('.popup-ad').forEach(popup => {
                popup.style.left = Math.floor(rand(10, window.innerWidth - 230)) + "px";
                popup.style.top = Math.floor(rand(10, window.innerHeight - 160)) + "px";
            });
        });
        document.addEventListener('keydown', e => {
            keyStates[e.key.toLowerCase()] = true;
            keyStates[e.code] = true;
        });
        document.addEventListener('keyup', e => {
            keyStates[e.key.toLowerCase()] = false;
            keyStates[e.code] = false;
        });
        function setButton(id, dir) {
            const btn = document.getElementById(id);
            function start(e) {
                e.preventDefault();
                btn.classList.add('active');
                if (dir === 'left') mobileLeft = true;
                if (dir === 'right') mobileRight = true;
                if (dir === 'jump') { mobileJump = true; mobileJumpQueued = true; }
            }
            function stop(e) {
                e.preventDefault();
                btn.classList.remove('active');
                if (dir === 'left') mobileLeft = false;
                if (dir === 'right') mobileRight = false;
                if (dir === 'jump') mobileJump = false;
            }
            btn.addEventListener('touchstart', start, {passive: false});
            btn.addEventListener('touchend', stop, {passive: false});
            btn.addEventListener('mousedown', start);
            btn.addEventListener('mouseup', stop);
            btn.addEventListener('mouseleave', stop);
            btn.addEventListener('mouseout', stop);
        }
        setButton('mc-left', 'left');
        setButton('mc-right', 'right');
        setButton('mc-jump', 'jump');
        canvas.addEventListener('touchstart', () => { canvas.focus(); });
        function draw() {
            ctx.fillStyle = `rgb(${Math.floor(rand(0,256))},${Math.floor(rand(0,256))},${Math.floor(rand(0,256))})`;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            platforms.forEach(plat => {
                ctx.fillStyle = platformColors[plat.c];
                ctx.fillRect(plat.x, plat.y, plat.w, plat.h);
                ctx.strokeStyle = '#ff0';
                ctx.lineWidth = 6;
                ctx.strokeRect(plat.x, plat.y, plat.w, plat.h);
            });
            if (!coin.collected) {
                ctx.beginPath();
                ctx.arc(coin.x, coin.y, coin.r, 0, Math.PI * 2);
                ctx.fillStyle = coinColor;
                ctx.fill();
                ctx.strokeStyle = '#00f';
                ctx.lineWidth = 4;
                ctx.stroke();
            }
            ctx.fillStyle = playerColor;
            ctx.fillRect(player.x, player.y, player.w, player.h);
            ctx.strokeStyle = '#f0f';
            ctx.lineWidth = 3;
            ctx.strokeRect(player.x, player.y, player.w, player.h);
            if (flashTextTimer > 0) {
                ctx.save();
                ctx.font = "bold 38px Comic Sans MS, Impact, sans-serif";
                ctx.textAlign = "center";
                ctx.shadowColor = randomColor();
                ctx.shadowBlur = 12;
                ctx.fillStyle = flashCounter % 2 === 0 ? randomColor() : randomColor();
                ctx.fillText(flashText, canvas.width / 2, 60);
                ctx.restore();
            }
        }
        function update() {
            let left = keyStates['arrowleft'] || keyStates['a'] || mobileLeft;
            let right = keyStates['arrowright'] || keyStates['d'] || mobileRight;
            let jumpKey = keyStates['arrowup'] || keyStates['w'] || keyStates[' '] || mobileJumpQueued;
            if ((left && !right)) player.x -= 3;
            if ((right && !left)) player.x += 3;
            if ((jumpKey) && player.onGround && !player.justJumped) {
                player.vy = getRandomJumpVelocity();
                player.onGround = false;
                player.justJumped = true;
                mobileJumpQueued = false;
            }
            if (!jumpKey && !mobileJump) player.justJumped = false;
            player.vy += 0.4;
            player.y += player.vy;
            player.onGround = false;
            for (const plat of platforms) {
                if (player.x < plat.x + plat.w && player.x + player.w > plat.x && player.y + player.h < plat.y + 10 &&
                    player.y + player.h + player.vy >= plat.y && player.y + player.h <= plat.y + plat.h) {
                    player.y = plat.y - player.h;
                    player.vy = 0;
                    player.onGround = true;
                }
            }
            for (const plat of platforms) {
                if (player.x < plat.x + plat.w && player.x + player.w > plat.x && player.y < plat.y + plat.h && player.y + player.h > plat.y) {
                    player.y = plat.y - player.h;
                    player.vy = 0;
                    player.onGround = true;
                }
            }
            if (!coin.collected) {
                let dx = (player.x + player.w / 2) - coin.x, dy = (player.y + player.h / 2) - coin.y;
                if (Math.sqrt(dx*dx + dy*dy) < coin.r + Math.max(player.w, player.h) / 2) {
                    coin.collected = true;
                    score++;
                    document.getElementById('scoreNum').textContent = score;
                    flashText = tacoAds[(levelIndex + 1) % tacoAds.length];
                    flashTextTimer = 60;
                    flashingText.style.color = randomColor();
                    flashingText.style.background = randomColor();
                    flashingText.textContent = flashText;
                    canvas.style.borderColor = randomColor();
                    setTimeout(() => canvas.style.borderColor = "#00f", 150);
                    setTimeout(showPopupAd, 500);
                }
            }
            if (coin.collected && flashTextTimer === 1) {
                levelIndex++;
                if (levelIndex >= levels.length) {
                    flashText = "ðŸŒ® TACO TOWN SEATTLE â€“ YOU WIN TACOS!";
                    flashTextTimer = 120;
                    flashingText.textContent = flashText;
                    levelIndex = 0;
                }
                startLevel(levelIndex);
            }
            if (player.y > 450) {
                Object.assign(player, {...levels[levelIndex].playerStart, w:20, h:30, vy:0});
            }
            if (flashTextTimer > 0) { flashTextTimer--; flashCounter++; }
        }
        function loop() {
            update();
            draw();
            requestAnimationFrame(loop);
        }
        startLevel(levelIndex);
        loop();
    </script>
</body>
</html>
